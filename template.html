<!doctype html>
<html lang="zh-TW">
    <head>
        <meta charset="UTF-8" />
        <title>電子發票證明聯</title>
        <style>
            @page {
                size: A4;
                margin: 0;
            }

            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }

            body {
                font-family: "Iansui", "Noto Sans", "Noto Sans TC", sans-serif;
                font-size: 10pt;
                width: 21cm;
                height: 29.7cm;
                padding: 1cm;
                background: white;
            }

            .invoice-container {
                width: 100%;
                height: 100%;
            }

            .header {
                text-align: center;
                margin-bottom: 8px;
            }

            .company-logo {
                font-size: 16pt;
                margin-bottom: 5px;
            }

            .invoice-title {
                font-size: 16pt;
                margin-bottom: 5px;
            }

            .invoice-date {
                font-size: 10pt;
                margin-bottom: 10px;
            }

            .info-section {
                display: flex;
                justify-content: space-between;
                margin-bottom: 5px;
            }

            .left-info {
                flex: 1;
            }

            .right-info {
                text-align: left;
            }

            .right-info div {
                display: flex;
            }

            .right-info-label {
                width: 180px;
            }

            .info-row {
                margin-bottom: 2px;
                display: flex;
            }

            .page-info {
                text-align: right;
                margin-bottom: 8px;
            }

            .main-table {
                width: 100%;
                border-collapse: collapse;
            }

            .main-table th,
            .main-table td {
                border: 1px solid #000;
                padding: 6px 8px;
                vertical-align: top;
            }

            .main-table th {
                font-weight: normal;
                background: white;
                text-align: center;
            }

            .col-name {
                width: 32%;
            }
            .col-qty {
                width: 8%;
                text-align: center;
            }
            .col-price {
                width: 15%;
                text-align: right;
            }
            .col-amount {
                width: 15%;
                text-align: right;
            }
            .col-remark {
                width: 30%;
                text-align: left;
            }

            .items-cell {
                height: 630px;
                vertical-align: top;
                padding-top: 8px;
            }

            .text-left {
                text-align: left;
            }
            .text-center {
                text-align: center;
            }
            .text-right {
                text-align: right;
            }

            .summary-label-cell {
                text-align: left;
                padding: 5px 8px;
            }

            .tax-cell {
                padding: 0;
            }

            .tax-inner {
                display: flex;
                height: 100%;
            }

            .tax-label {
                padding: 5px 8px;
                border-right: 1px solid #000;
                display: flex;
                align-items: center;
            }

            .tax-options {
                display: flex;
                flex: 1;
            }

            .tax-option {
                flex: 1;
                display: flex;
                align-items: center;
                justify-content: center;
                border-top: none;
                border-bottom: none;
                border-right: 1px solid #000;
            }

            .tax-option:last-child {
                border-right: none;
            }

            .checkbox {
                display: inline-block;
                margin-left: 5px;
                font-size: 12px;
                vertical-align: middle;
            }

            .checkbox.checked::before {
                content: "√";
            }

            .checkbox:not(.checked)::before {
                content: " ";
            }

            .stamp-cell {
                vertical-align: top;
                padding: 8px;
            }

            .stamp-title {
                text-align: center;
                font-size: 10pt;
                margin-bottom: 3px;
            }

            .stamp-note {
                text-align: center;
                font-size: 8pt;
                margin-bottom: 8px;
            }

            .seller-info-row {
                display: flex;
                font-size: 8pt;
                margin-bottom: 2px;
            }

            .seller-label {
                width: 60px;
                flex-shrink: 0;
            }

            .seller-value {
                flex: 1;
                word-break: break-all;
            }
        </style>
    </head>
    <body>
        <div class="invoice-container">
            <div class="header">
                <div class="company-logo">{{sellerName}}</div>
                <div class="invoice-title">電子發票證明聯</div>
                <div class="invoice-date">{{invoiceDate}}</div>
            </div>

            <div class="info-section">
                <div class="left-info">
                    <div class="info-row">發票號碼：{{invoiceNumber}}</div>
                    <div class="info-row">買　　方：{{buyerName}}</div>
                    <div class="info-row">統一編號：{{buyerTaxId}}</div>
                    <div class="info-row">地　　址：{{buyerAddress}}</div>
                </div>
                <div class="right-info">
                    <div>
                        <span class="right-info-label">格　　　式：{{formatCode}}</span>
                    </div>
                    <div>
                        <span class="right-info-label">隨　機　碼：{{randomCode}}</span>
                    </div>
                </div>
            </div>

            <div class="page-info">
                第 {{currentPage}} 頁/共 {{totalPages}} 頁
            </div>

            <table class="main-table">
                <thead>
                    <tr>
                        <th class="col-name">品名</th>
                        <th class="col-qty">數量</th>
                        <th class="col-price">單價</th>
                        <th class="col-amount">金額</th>
                        <th class="col-remark">備註</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="items-cell text-left">{{itemsContent}}</td>
                        <td class="items-cell text-center">
                            {{quantitiesContent}}
                        </td>
                        <td class="items-cell text-right">{{pricesContent}}</td>
                        <td class="items-cell text-right">
                            {{amountsContent}}
                        </td>
                        <td class="items-cell text-left">{{remarksContent}}</td>
                    </tr>
                    <tr>
                        <td colspan="3" class="summary-label-cell">
                            銷售額合計
                        </td>
                        <td class="text-right">{{salesAmount}}</td>
                        <td rowspan="4" class="stamp-cell">
                            <div class="stamp-title">
                                營業人蓋統一發票專用章
                            </div>
                            <div class="stamp-note">
                                （已條列營業人資料者得免蓋章）
                            </div>
                            <div class="seller-info-row">
                                <span class="seller-label">賣　　方：</span>
                                <span class="seller-value">{{sellerName}}</span>
                            </div>
                            <div class="seller-info-row">
                                <span class="seller-label">統一編號：</span>
                                <span class="seller-value"
                                    >{{sellerTaxId}}</span
                                >
                            </div>
                            <div class="seller-info-row">
                                <span class="seller-label">地　　址：</span>
                                <span class="seller-value"
                                    >{{sellerAddress}}</span
                                >
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" style="padding: 0; height: 1px;">
                            <table style="width: 100%; height: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="border-top: none;border-bottom: none;border-left: none;border-right: 1px solid #000; text-align: center;">營業稅</td>
                                    <td style="border-top: none;border-bottom: none;border-left: none;border-right: 1px solid #000; text-align: center;">應稅</td>
                                    <td style="border-top: none;border-bottom: none;border-left: none;border-right: 1px solid #000; text-align: center;"><span class="checkbox {{taxableChecked}}"></span></td>
                                    <td style="border-top: none;border-bottom: none;border-left: none;border-right: 1px solid #000; text-align: center;">零稅率</td>
                                    <td style="border-top: none;border-bottom: none;border-left: none;border-right: 1px solid #000; text-align: center;"><span class="checkbox {{zeroTaxChecked}}"></span></td>
                                    <td style="border-top: none;border-bottom: none;border-left: none;border-right: 1px solid #000; text-align: center;">免稅</td>
                                    <td style="border-top: none;border-bottom: none;border-left: none;border-right: none; text-align: center;"><span class="checkbox {{taxFreeChecked}}"></span></td>
                                </tr>
                            </table>
                        </td>
                        <td class="text-right">{{taxAmount}}</td>
                    </tr>
                    <tr>
                        <td colspan="3" class="summary-label-cell">總計</td>
                        <td class="text-right">{{totalAmount}}</td>
                    </tr>
                    <tr>
                        <td colspan="1" class="summary-label-cell" style="border-right: none;">
                            總計新臺幣</br>(中文大寫)
                        </td>
                        <td colspan="3" class="text-right" style="border-left: none; vertical-align: middle;font-size: 16px;">
                            {{totalAmountChinese}}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>
